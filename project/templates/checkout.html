{% extends 'base.html' %}

{% import 'bootstrap/form.html' as wtf %}

{% block main %}
<style>
    .method-5,
    .method-8,
    .method-15,
    .method-25 {
        display: block;

    }

    select:has(option[value="5"]:checked) .method-5,
    select:has(option[value="8"]:checked) .method-8,
    select:has(option[value="15"]:checked) .method-15,
    select:has(option[value="25"]:checked) .method-25 {
        display: block;
    }
</style>

<section class="py-5">
    <div class="container">
        <div class="container mx-10 my-2">
            <h2>Checkout</h2>

            <p>Please provide your details to place your order. Thank you!</p>

            <div class="row">
                <div class="col-lg-4 order-lg-2 mb-4">
                    <div class="card shadow-sm">
                        <div class="card-header bg-white border-bottom">
                            <h4 class="d-flex justify-content-between align-items-center mb-2">
                                <span>Your Cart</span>
                                <span class="badge bg-secondary rounded-pill">{{ basket_num_items }}</span>
                            </h4>
                        </div>
                        <ul class="list-group list-group-flush">
                            {% for item in basket.items %}
                            <li class="list-group-item d-flex justify-content-between align-items-start">
                                <div>
                                    <h6 class="my-0 fw-semibold">{{ item.item.itemName }}</h6>
                                    <small class="text-muted">${{ item.item.unitPrice }} x {{ item.quantity }}</small>
                                </div>
                                <span class="text-muted">${{ item.total_price() }}</span>
                            </li>
                            {% endfor %}

                            <li class="list-group-item">
                                <form method="GET" action="{{ url_for('main.checkout') }}"
                                    class="d-flex justify-content-between align-items-center">
                                    <label for="delivery" class="me-2 mb-0 fw-medium">Delivery:</label>
                                    <select name="delivery" id="delivery" class="form-select form-select-sm w-auto">
                                        {% for method in delivery_methods %}
                                        <option value="{{ method.value }}" {% if selected_method==method.value
                                            %}selected{% endif %}>
                                            {{ method.name }} - ${{ method.value }}
                                        </option>
                                        {% endfor %}
                                    </select>

                                </form>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <span>Delivery Charges (Standard)</span>
                                <span class="text-muted">$5</span>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <strong>Total (AUD)</strong>
                                <strong>${{ basket_total + 5 }}</strong>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <span>Delivery Charges (Express)</span>
                                <span class="text-muted">$8</span>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <strong>Total (AUD)</strong>
                                <strong>${{ basket_total + 8 }}</strong>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <span>Delivery Charges (Eco)</span>
                                <span class="text-muted">$15</span>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <strong>Total (AUD)</strong>
                                <strong>${{ basket_total + 15 }}</strong>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <span>Delivery Charges (Temp-Control)</span>
                                <span class="text-muted">$25</span>
                            </li>

                            <li class="list-group-item d-flex justify-content-between">
                                <strong>Total (AUD)</strong>
                                <strong>${{ basket_total + 5 }}</strong>
                            </li>

                        </ul>
                    </div>
                </div>

                <div class="col-md-8 order-lg-1">
                    <div class="card p-4 mb-3">
                        <h4 class="fw-bold">Your Details</h4>
                        <form method="post" name="checkout-form" class="needs-validation" novalidate>
                            <!--{{ wtf.render_form(form) }}-->
                            {{ wtf.render_field(form.firstname, class_='form-control mb-3', placeholder='John') }}
                            {{ wtf.render_field(form.surname, class_='form-control mb-3', placeholder='Doe') }}
                            {{ wtf.render_field(form.email, class_='form-control mb-3', placeholder='email@email.com')}}
                            {{ wtf.render_field(form.phone, class_='form-control mb-3', placeholder='xxxxxxxxxx') }}
                            {{ wtf.render_field(form.address1, class_='form-control mb-3', placeholder='ABC Street') }}
                            {{ wtf.render_field(form.address2, class_='form-control mb-3',
                            placeholder='Apartment,suite,etc.') }}
                            {{ wtf.render_field(form.city, class_='form-control mb-3', placeholder='City') }}
                            {{ wtf.render_field(form.state, class_='form-control mb-3', placeholder='State') }}
                            {{ wtf.render_field(form.postcode, class_='form-control mb-3', placeholder='XXXX') }}
                            {{ wtf.render_field(form.deliverymethod, class_='form-select mb-3') }}
                            {{ wtf.render_field(form.paymenttype, class_='form-select mb-3') }}
                            {{ wtf.render_field(form.nameoncard, class_='form-control me-3', placeholder='John Doe') }}
                            {{ wtf.render_field(form.cardnumber, class_='form-control
                            mb-3',placeholder='XXXXXXXXXXXXXXXXXXXX') }}
                            {{ wtf.render_field(form.expirydate, class_='form-control mb-3', placeholder='MM/YY') }}
                            {{ wtf.render_field(form.cvv, class_='form-control mb-3', placeholder='***') }}

                            {{ wtf.render_field(form.submit, class_='btn btn-primary') }}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}